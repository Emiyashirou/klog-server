package com.klog.api;

import com.amazonaws.services.lambda.runtime.Context;
import com.amazonaws.services.lambda.runtime.RequestHandler;
import com.klog.exception.InternalServerErrorException;
import org.apache.commons.dbutils.DbUtils;

import java.sql.Connection;
import java.sql.ResultSet;
import java.util.HashMap;
import java.util.Map;

import static com.klog.connection.MySQLConnection.connect;
import static com.sun.xml.internal.ws.spi.db.BindingContextFactory.LOGGER;

public class GetPostList implements RequestHandler<Object, Object> {

    public Map<String, Object> handleRequest(Object input, Context context) {

        System.getProperties().setProperty("org.jooq.no-logo", "true");

        ResultSet rs = null;
        Connection conn = null;
        Map<String, Object> result = new HashMap<>();

        try {
             conn = connect();
             return result;
        } catch (Exception e) {
            LOGGER.info(e.getMessage());
            throw new InternalServerErrorException("Internal server error");
        } finally {
            DbUtils.closeQuietly(rs);
            DbUtils.closeQuietly(conn);
        }
    }
}
